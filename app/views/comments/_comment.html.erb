<div id="cmt-<%= comment.id %>" class="">
	<div class="row no-gutter mx-auto" onmouseover='$("#options-<%= comment.id %>").show()' onmouseleave='$("#options-<%= comment.id %>").hide()'>
		<div onclick='execReply("<%= comment.id %>");' class="col-1 ml-3 py-2">
			<div class="mt-1 pr-0">
				<% unless !comment.user.photo.attached? %><%= link_to image_tag(comment.user.photo, class: "rounded-circle w-100 px-0"), user_path(comment.user) %><% else %><%= fa_icon('user 2x', class: "pr-0") %><% end %>
			</div>
		</div>
		<div class="col-9 small pl-0">
			<div class="small mb-1 mt-1" style="">
				<% if comment.user.occupation.present? %>
					<h7><%= comment.user.first_name + " " + comment.user.last_name + " 路 " + comment.user.occupation %></h7>
				<% else %>
					<%= comment.user.first_name + " " + comment.user.last_name %>
				<% end %>
			</div>
			<div class="">
				<%= simple_format(comment.content).gsub(URI.regexp, '<a href="\0">\0</a>').html_safe %>
			</div>
		</div>
		<div id="options-<%= comment.id %>" class="col-1 mt-4 options">
			<div class="col-1 dropdown px-0">
				<span class="pointer" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
					<%= fa_icon('ellipsis-v', class: "icon-text text-muted") %>
				</span>
				<div class="dropdown-menu mr-5" aria-labelledby="dropdownMenuButton">
					<span class="dropdown-item"><%= link_to fa_icon('flag', class: "profile-link pointer") + "  Flag content", wad_comment_flag_path(@wad, comment), remote: true, class: "profile-link" %></span>
					<% if current_user == comment.user %>
					<span class="dropdown-item"><%= link_to fa_icon("trash", class: " profile-link pointer") + " Remove Comment", wad_comment_path(@wad, comment), method: :delete, remote: true,  class: "profile-link" %></span>
					<% end %>
				</div>
			</div>
		</div>
	</div>
	<div class="row ml-1 mb-2">
		<div class="col-1">
		</div>
		<div class="col-9">
			<div class="small ml-1 row">
				<% if current_user.voted_down_on?(comment) || !current_user.voted_for?(comment) %>
					<div class="" id="vote-span-<%= comment.id %>"><%= link_to image_tag('thumbs-up-regular.svg', class: "sm-icon-pic"), wad_comment_like_path(comment.wad, comment), method: :put, remote: true, class: "profile-link" %><span class="small like-<%= comment.id %>" id="like-<%= comment.id %>"><%= comment.get_upvotes.count %></span></div>
				<% else %>
					<div class="" id="vote-span-<%= comment.id %>"><%= link_to image_tag('thumbs-up-orange.png', class: "sm-cmt-png-icon"), wad_comment_dislike_path(comment.wad, comment), method: :put, remote: true, class: "profile-link" %><span class="small like-<%= comment.id %>" id=""><%= comment.get_upvotes.count %></span></div>
				<% end %>
				<div class="col-1">
				</div>
				<div class="pointer" id="btn-hide" onclick='execReply("<%= comment.id %>")'>	<%= image_tag('comment-dots-regular.svg', class: "sm-icon-pic") %></div>
			</div>
		</div>
	</div>
	<div id="cmt-form-<%= comment.id %>" class="text-center cmt-forms col-12">
		<%= render 'form', comment: comment %>
	</div>
	<div class="row ml-1">
		<div class="col-1">
		</div>
		<div id="see-replies-holder-<%= comment.id %>" class="small col-9" onclick='seeReply("<%= comment.id %>");'>
			<% if comment.children.exists? %>
					<span id="see-replies-<%= comment.id %>" class="see-replies small pointer">Show replies <%= fa_icon('caret-down')%></span>
			<% end %>
		</div>
	</div>
	<div class="row no-gutters">
		<div id="reply-<%= comment.id %>" class="reply-hide-area col-12">
			<div id="new-cmt-<%= comment.id %>" class="">

			</div>

			<% comment.descendants.each do |c| %>
				<div id="cmt-<%= c.id %>" class="small col-10 mx-auto row" onmouseover='$("#options-<%= c.id %>").show()' onmouseleave='$("#options-<%= c.id %>").hide()'>
					<div class="col-10 mt-2 mb-1 small">
						<% if !c.user.occupation || c.user.occupation == "" %><%= link_to c.user.name, user_path(c.user) %><%= " 路 "  + c.user.points.to_s %><% else %><%= link_to c.user.name , user_path(c.user) %><%= " 路 " + c.user.occupation %><%= " 路 "  + c.user.points.to_s %><% end %>
						<div class="col-12 mt-1">
							<% if c.parent == comment %>
								<%= link_to c.content, user_path(c.user), class: "profile-link" %>
							<% else %>
								<%= link_to c.content, user_path(c.parent.user), class: "profile-link" %>
							<% end %>
						</div>
					</div>
					<div id="options-<%= c.id %>" class="col-1 options mt-3">
						<div class="col-1 dropdown pointer">
					    <span class="" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
					      <%= fa_icon('ellipsis-v', class: "icon-text text-muted") %>
					    </span>
					    <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
					      <span class="dropdown-item"><%= link_to fa_icon('flag', class: " profile-link pointer") + "  Flag content", wad_comment_flag_path(@wad, c), remote: true, class: "profile-link" %></span>
					      <% if current_user == c.user %>
					        <span class="dropdown-item profile-link"><%= link_to fa_icon("trash", class: "profile-link pointer"), wad_comment_path(@wad, c), method: :delete, remote: true %><span class="profile-link"> Remove Comment</span>
					      <% end %>
					    </div>
					  </div>
					</div>
				</div>
				<div id="cmt-opts-<%= c.id %>" class="row small ml-2">
					<div class="col-10 row small">
						<div class="col-2">
						</div>
						<% if current_user.voted_down_on?(c) || !current_user.voted_for?(c) %>
							<div class="d-inline col-2" id="vote-span-<%= c.id %>"><%= link_to image_tag('thumbs-up-regular.svg', class: "sm-icon-pic"), wad_comment_like_path(c.wad, c), method: :put, remote: true, class: "profile-link" %><span class="small d-inline like-<%= c.id %>" id="like-<%= c.id %>"><%= c.get_upvotes.count %></span></div>
						<% else %>
							<div class="col-2" id="vote-span-<%= c.id %>"><%= link_to image_tag('thumbs-up-orange.png', class: "sm-cmt-png-icon"), wad_comment_dislike_path(c.wad, c), method: :put, remote: true, class: "profile-link" %><span class="small like-<%= c.id %>" id="like-<%= c.id %>"><%= c.get_upvotes.count %></span></div>
						<% end %>
						<div class="profile-link child-cmt pointer col-3" onclick='secondaryReply("<%= comment.id %>", "<%= c.id %>", "<%= c.user.name %>");'>REPLY</div>
					</div>
				</div>
				<div id="cmt-form-<%= c.id %>" class="cmt-forms">
					<div class="">
						<%= form_for([@wad, @comment], class: "", remote: true) do |f| %>
							<div class="row">
								<div class="col-2">

								</div>
									<div class="col-6">
											<%= f.text_area :content, placeholder: "Leave a comment...", id: "form-field-#{c.id}", class: "border-bottom comment-reply-form form-control form-field-#{c.id} autoExpand no-resize form-field", rows: "1", onkeyup: "activeBox('#{c.id}')" %>
											<%= f.hidden_field :wad_id %>
											<%= f.hidden_field :parent_id, class: "hid-field" %>
									</div>
									<div class="col-3">
										<%= f.submit 'Comment', class: 'mt-1 mb-1 comment-btn btn-sm comment-reply-btn pointer w-50', onclick: "$('#cmt-form-#{c.id}').hide()" %>
									</div>
							</div>
						<% end %>
					</div>
				</div>
			<% end %>
		</div>
	</div>
</div>
